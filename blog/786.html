<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta name="description" content="Java technology blog.">
  <meta name="keyword" content="hexo-theme, vuejs">
  
    <link rel="shortcut icon" href="/css/images/logo.png">
  
  <title>
    
      Java成神之路-数据库、PowerDesigner、JDBC（七） | Keis Note
    
  </title>
  <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.css" rel="stylesheet">
  <link href="//cdn.bootcss.com/highlight.js/9.12.0/styles/tomorrow.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/plugins/gitment.css">
  <script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
  <script src="//cdn.bootcss.com/geopattern/1.2.3/js/geopattern.min.js"></script>
  <script src="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>
  <script src="/js/qrious.js"></script>
<script src="/js/gitment.js"></script>
  
  
    <!-- MathJax support START -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- MathJax support END -->
  


</head>
<div class="wechat-share">
  <img src="/css/images/logo.png" />
</div>

  <body>
    <header class="header fixed-header">
  <div class="header-container">
    <a class="home-link" href="/">
      <div class="logo"></div>
      <span>Keis Note</span>
    </a>
    <ul class="right-list">
      
        <li class="list-item">
          
            <a href="/" class="item-link">Home</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/tags/" class="item-link">Tags</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/archives/" class="item-link">Archives</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/project/" class="item-link">Projects</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/about/" class="item-link">About</a>
          
        </li>
      
    </ul>
    <div class="menu">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </div>
    <div class="menu-mask">
      <ul class="menu-list">
        
          <li class="menu-item">
            
              <a href="/" class="menu-link">Home</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/tags/" class="menu-link">Tags</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/archives/" class="menu-link">Archives</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/project/" class="menu-link">Projects</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/about/" class="menu-link">About</a>
            
          </li>
        
      </ul>
    </div>
  </div>
</header>

    <div id="article-banner">
  <h2>Java成神之路-数据库、PowerDesigner、JDBC（七）</h2>
  <p class="post-date">2018-02-23</p>
  <div class="arrow-down">
    <a href="javascript:;"></a>
  </div>
</div>
<main class="app-body flex-box">
  <!-- Article START -->
  <article class="post-article">
    <section class="markdown-content"><p><img src="http://ovi3ob9p4.bkt.clouddn.com/TIETU/CT0132.jpg" alt="image"></p>
<p>Java成神之路-数据库、PowerDesigner、JDBC<br><a id="more"></a></p>
<h1 id="Mysql数据库"><a href="#Mysql数据库" class="headerlink" title="Mysql数据库"></a>Mysql数据库</h1><h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">net <span class="keyword">start</span> mysql //　　启动MYSQL服务</span><br><span class="line">net <span class="keyword">stop</span> mysql  //　　停止MYSQL服务 </span><br><span class="line">netstat –na | findstr <span class="number">3306</span> //查看被监听的端口 , findstr用于查找后面的端口是否存在 </span><br><span class="line">mysql –<span class="keyword">user</span>=root –<span class="keyword">password</span>=<span class="number">123456</span> db_name //在命令行中登陆MYSQL控制台 , 即使用 MYSQL COMMEND LINE TOOL </span><br><span class="line">mysql –u root –p123456 db_name //在命令行中登陆MYSQL控制台</span><br><span class="line">// 进入MYSQL命令行工具后 , 使用<span class="keyword">status</span>; 或\s 查看运行环境信息 </span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> new_dbname; //　切换连接数据库的语法</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">databases</span>; //　显示所有数据库</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;    //　显示数据库中的所有表</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> table_name; 　//显示某个表创建时的全部信息　 </span><br><span class="line"><span class="keyword">Describe</span> table_name;   desc table_name; //查看表的具体属性信息及表中各字段的描述 </span><br><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> <span class="keyword">name</span>; //创建数据库 </span><br><span class="line"><span class="keyword">use</span> databasename; //选择数据库 </span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">database</span> <span class="keyword">name</span> //直接删除数据库，不提醒 </span><br><span class="line">mysqladmin <span class="keyword">drop</span> databasename //删除数据库前，有提示。 </span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>; //显示表 </span><br><span class="line"><span class="keyword">describe</span> tablename; //表的详细描述</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">version</span>(),<span class="keyword">current_date</span>;  //显示当前mysql版本和当前日期   </span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="string">`name`</span> <span class="keyword">from</span> <span class="keyword">users</span>; //<span class="keyword">select</span> 中加上<span class="keyword">distinct</span>去除重复字段 </span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="keyword">name</span>,age <span class="keyword">FROM</span> <span class="keyword">users</span>; //<span class="keyword">select</span> 中加上<span class="keyword">distinct</span>去除重复字段 </span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">count</span>(<span class="keyword">DISTINCT</span> <span class="keyword">name</span>,age) <span class="keyword">FROM</span> <span class="keyword">users</span>; //<span class="keyword">select</span> 中加上<span class="keyword">distinct</span>去除重复字段</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> table_name; //查询:查询所有数据</span><br><span class="line"><span class="keyword">select</span> 字段<span class="number">1</span> , 字段<span class="number">2</span> <span class="keyword">from</span> table_name; //查询指定字段的数据</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tablename; //Mysql命令查询一个表的记录总数</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">as</span> <span class="keyword">num</span> <span class="keyword">from</span> tablename; //Mysql命令查询一个表的记录总数</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">as</span> total <span class="keyword">from</span> tablename; //Mysql命令查询一个表的记录总数</span><br><span class="line"></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> t1 <span class="keyword">rename</span> t2; //重新命名表</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">database</span> db_name;  //数据库创建</span><br><span class="line"><span class="keyword">Drop</span> <span class="keyword">database</span> db_name; //数据库删除 </span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">database</span> <span class="keyword">if</span> exits db_name //删除时先判断是否存在</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> table_name (字段<span class="number">1</span> 数据类型 , 字段<span class="number">2</span> 数据类型); //建表 : 创建数据表的语法</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> mytable (<span class="keyword">id</span> <span class="built_in">int</span> , username <span class="built_in">char</span>(<span class="number">20</span>)); //建表示例</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> username1 <span class="keyword">identified</span> <span class="keyword">BY</span> ‘<span class="keyword">password</span>’ , username2 <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> ‘<span class="keyword">password</span>’…. //创建数据库用户</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> table_name;  //删表</span><br><span class="line"><span class="keyword">Insert</span> <span class="keyword">into</span> 表名 [(字段<span class="number">1</span> , 字段<span class="number">2</span> , ….)] <span class="keyword">values</span> (值<span class="number">1</span> , 值<span class="number">2</span> , …..); //添加数据 </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> mytable (<span class="keyword">id</span>,username) <span class="keyword">values</span> (<span class="number">1</span>,’zhangsan’); //　如果向表中的每个字段都插入一个值,那么前面 [ ] 括号内字段名可写也可不写</span><br><span class="line"><span class="keyword">Update</span> table_name <span class="keyword">set</span> 字段名=’新值’ [, 字段<span class="number">2</span> =’新值’ , …..][<span class="keyword">where</span> <span class="keyword">id</span>=id_num] [<span class="keyword">order</span> <span class="keyword">by</span> 字段 顺序]</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> table_name; //删除整个表中的信息</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> table_name <span class="keyword">where</span> 条件语句 ; 条件语句如 : id=3; //删除表中指定条件的语句 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">Grant</span> all <span class="keyword">ON</span> db_name.table_name <span class="keyword">TO</span> user_name [ indentified <span class="keyword">by</span> ‘<span class="keyword">password</span>’ ]; //库，表级的权限控制,将某库中的某表的控制权赋予某用户</span><br><span class="line"></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> table_name <span class="keyword">add</span> <span class="keyword">column</span> (字段名 字段类型); //增加一个字段格式<span class="comment">----此方法带括号 </span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> table_name <span class="keyword">add</span> <span class="keyword">column</span> 字段名 字段类型 <span class="keyword">after</span> 某字段；//指定字段插入的位置 </span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> table_name <span class="keyword">drop</span>字段名; //删除一个字段</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> table_name <span class="keyword">change</span> 旧字段名 新字段名 新字段的类型; //修改字段名称/类型</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> table_name <span class="keyword">rename</span> <span class="keyword">to</span> new_table_name; //改表的名字</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">ENGINE</span>=MyISAM | <span class="keyword">InnoDB</span>;  //修改数据库引擎 </span><br><span class="line"><span class="keyword">truncate</span> <span class="keyword">table</span> table_name; //清空表中的所有数据 此方法也会使表中的取号器(ID)从1开始 </span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table_name; //查看数据库当前引擎</span><br></pre></td></tr></table></figure>
<h2 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">shell&gt;mysql -u root -p </span><br><span class="line">mysql&gt; update user set password=password(”xueok654123″) where user=’root’; </span><br><span class="line">mysql&gt; flush privileges //刷新数据库 </span><br><span class="line">mysql&gt;use dbname； //打开数据库： </span><br><span class="line">mysql&gt;show databases; //显示所有数据库 </span><br><span class="line">mysql&gt;show tables; //显示数据库mysql中所有的表：先use mysql；然后 </span><br><span class="line">mysql&gt;describe user; //显示表mysql数据库中user表的列信息）；</span><br></pre></td></tr></table></figure>
<h2 id="授权"><a href="#授权" class="headerlink" title="授权"></a>授权</h2><p>创建一个从任何地方连接服务器的超级用户，使用一个口令something</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; grant all privileges on *.* to user@localhost identified by ’something’ with</span><br></pre></td></tr></table></figure>
<p>增加新用户<br>格式：grant select on 数据库.* to 用户名@登录主机 identified by “密码” </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> ALL <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> monty@localhost <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> ’something’ <span class="keyword">WITH</span> <span class="keyword">GRANT</span> <span class="keyword">OPTION</span>; </span><br><span class="line"><span class="keyword">GRANT</span> ALL <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> monty@”%” <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> ’something’ <span class="keyword">WITH</span> <span class="keyword">GRANT</span> <span class="keyword">OPTION</span>;</span><br></pre></td></tr></table></figure>
<p>删除授权： </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; revoke all privileges on *.* from root@”%”; </span><br><span class="line">mysql&gt; delete from user where user=”root” and host=”%”; </span><br><span class="line">mysql&gt; flush privileges;</span><br></pre></td></tr></table></figure>
<p>创建一个用户custom在特定客户端it363.com登录，可访问特定数据库fangchandb </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql &gt;grant select, insert, update, delete, create,drop on fangchandb.* to custom@ it363.com identified by ‘ passwd’</span><br></pre></td></tr></table></figure>
<h2 id="备份"><a href="#备份" class="headerlink" title="备份"></a>备份</h2><p>备份数据库 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; mysqldump -h host -u root -p dbname &gt;dbname_backup.sql</span><br></pre></td></tr></table></figure>
<p>恢复数据库 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; mysqladmin -h myhost -u root -p create dbname </span><br><span class="line">shell&gt; mysqldump -h host -u root -p dbname &lt; dbname_backup.sql</span><br></pre></td></tr></table></figure>
<p>如果只想卸出建表指令，则命令如下： </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; mysqladmin -u root -p -d databasename &gt; a.sql</span><br></pre></td></tr></table></figure>
<p>如果只想卸出插入数据的sql命令，而不需要建表命令，则命令如下： </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; mysqladmin -u root -p -t databasename &gt; a.sql</span><br></pre></td></tr></table></figure>
<h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">1、说明：创建数据库</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="keyword">database</span>-<span class="keyword">name</span></span><br><span class="line"><span class="number">2</span>、说明：删除数据库</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">database</span> dbname</span><br><span class="line"><span class="number">3</span>、说明：备份<span class="keyword">sql</span> <span class="keyword">server</span></span><br><span class="line"><span class="comment">--- 创建 备份数据的 device</span></span><br><span class="line"><span class="keyword">USE</span> <span class="keyword">master</span></span><br><span class="line">EXEC sp_addumpdevice <span class="string">'disk'</span>, <span class="string">'testBack'</span>, <span class="string">'c:\mssql7backup\MyNwind_1.dat'</span></span><br><span class="line"><span class="comment">--- 开始 备份</span></span><br><span class="line"><span class="keyword">BACKUP</span> <span class="keyword">DATABASE</span> pubs <span class="keyword">TO</span> testBack</span><br><span class="line"><span class="number">4</span>、说明：创建新表</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tabname(col1 type1 [<span class="keyword">not</span> <span class="literal">null</span>] [primary <span class="keyword">key</span>],col2 type2 [<span class="keyword">not</span> <span class="literal">null</span>],..)</span><br><span class="line">根据已有的表创建新表：</span><br><span class="line">A：<span class="keyword">create</span> <span class="keyword">table</span> tab_new <span class="keyword">like</span> tab_old (使用旧表创建新表)</span><br><span class="line">B：<span class="keyword">create</span> <span class="keyword">table</span> tab_new <span class="keyword">as</span> <span class="keyword">select</span> col1,col2… <span class="keyword">from</span> tab_old definition <span class="keyword">only</span></span><br><span class="line"><span class="number">5</span>、说明：删除新表</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> tabname</span><br><span class="line"><span class="number">6</span>、说明：增加一个列</span><br><span class="line"><span class="keyword">Alter</span> <span class="keyword">table</span> tabname <span class="keyword">add</span> <span class="keyword">column</span> <span class="keyword">col</span> <span class="keyword">type</span></span><br><span class="line">注：列增加后将不能删除。DB2中列加上后数据类型也不能改变，唯一能改变的是增加<span class="built_in">varchar</span>类型的长度。</span><br><span class="line"><span class="number">7</span>、说明：添加主键： <span class="keyword">Alter</span> <span class="keyword">table</span> tabname <span class="keyword">add</span> primary <span class="keyword">key</span>(<span class="keyword">col</span>)</span><br><span class="line">说明：删除主键： <span class="keyword">Alter</span> <span class="keyword">table</span> tabname <span class="keyword">drop</span> primary <span class="keyword">key</span>(<span class="keyword">col</span>)</span><br><span class="line"><span class="number">8</span>、说明：创建索引：<span class="keyword">create</span> [<span class="keyword">unique</span>] <span class="keyword">index</span> idxname <span class="keyword">on</span> tabname(<span class="keyword">col</span>….)</span><br><span class="line">删除索引：<span class="keyword">drop</span> <span class="keyword">index</span> idxname</span><br><span class="line">注：索引是不可更改的，想更改必须删除重新建。</span><br><span class="line"><span class="number">9</span>、说明：创建视图：<span class="keyword">create</span> <span class="keyword">view</span> viewname <span class="keyword">as</span> <span class="keyword">select</span> <span class="keyword">statement</span></span><br><span class="line">删除视图：<span class="keyword">drop</span> <span class="keyword">view</span> viewname</span><br><span class="line"><span class="number">10</span>、说明：几个简单的基本的<span class="keyword">sql</span>语句</span><br><span class="line">选择：<span class="keyword">select</span> * <span class="keyword">from</span> table1 <span class="keyword">where</span> 范围</span><br><span class="line">插入：<span class="keyword">insert</span> <span class="keyword">into</span> table1(field1,field2) <span class="keyword">values</span>(value1,value2)</span><br><span class="line">删除：<span class="keyword">delete</span> <span class="keyword">from</span> table1 <span class="keyword">where</span> 范围</span><br><span class="line">更新：<span class="keyword">update</span> table1 <span class="keyword">set</span> field1=value1 <span class="keyword">where</span> 范围</span><br><span class="line">查找：<span class="keyword">select</span> * <span class="keyword">from</span> table1 <span class="keyword">where</span> field1 <span class="keyword">like</span> ’%value1%’ <span class="comment">---like的语法很精妙，查资料!</span></span><br><span class="line">排序：<span class="keyword">select</span> * <span class="keyword">from</span> table1 <span class="keyword">order</span> <span class="keyword">by</span> field1,field2 [<span class="keyword">desc</span>]</span><br><span class="line">总数：<span class="keyword">select</span> <span class="keyword">count</span> <span class="keyword">as</span> totalcount <span class="keyword">from</span> table1</span><br><span class="line">求和：<span class="keyword">select</span> <span class="keyword">sum</span>(field1) <span class="keyword">as</span> sumvalue <span class="keyword">from</span> table1</span><br><span class="line">平均：<span class="keyword">select</span> <span class="keyword">avg</span>(field1) <span class="keyword">as</span> avgvalue <span class="keyword">from</span> table1</span><br><span class="line">最大：<span class="keyword">select</span> <span class="keyword">max</span>(field1) <span class="keyword">as</span> maxvalue <span class="keyword">from</span> table1</span><br><span class="line">最小：<span class="keyword">select</span> <span class="keyword">min</span>(field1) <span class="keyword">as</span> <span class="keyword">minvalue</span> <span class="keyword">from</span> table1</span><br><span class="line"><span class="number">11</span>、说明：几个高级查询运算词</span><br><span class="line">A： <span class="keyword">UNION</span> 运算符</span><br><span class="line"><span class="keyword">UNION</span> 运算符通过组合其他两个结果表（例如 TABLE1 和 TABLE2）并消去表中任何重复行而派生出一个结果表。当 ALL 随 <span class="keyword">UNION</span> 一起使用时（即 <span class="keyword">UNION</span> ALL），不消除重复行。</span><br><span class="line">两种情况下，派生表的每一行不是来自 TABLE1 就是来自 TABLE2。</span><br><span class="line">B： <span class="keyword">EXCEPT</span> 运算符</span><br><span class="line"><span class="keyword">EXCEPT</span> 运算符通过包括所有在 TABLE1 中但不在 TABLE2 中的行并消除所有重复行而派生出一个结果表。当 ALL 随 <span class="keyword">EXCEPT</span> 一起使用时 (<span class="keyword">EXCEPT</span> ALL)，不消除重复行。</span><br><span class="line">C： <span class="keyword">INTERSECT</span> 运算符</span><br><span class="line"><span class="keyword">INTERSECT</span> 运算符通过只包括 TABLE1 和 TABLE2 中都有的行并消除所有重复行而派生出一个结果表。当 ALL 随 <span class="keyword">INTERSECT</span> 一起使用时 (<span class="keyword">INTERSECT</span> ALL)，不消除重复行。</span><br><span class="line">注：使用运算词的几个查询结果行必须是一致的。</span><br><span class="line"><span class="number">12</span>、说明：使用外连接</span><br><span class="line">A、<span class="keyword">left</span> （<span class="keyword">outer</span>） <span class="keyword">join</span>：</span><br><span class="line">左外连接（左连接）：结果集几包括连接表的匹配行，也包括左连接表的所有行。</span><br><span class="line"><span class="keyword">SQL</span>: <span class="keyword">select</span> a.a, a.b, a.c, b.c, b.d, b.f <span class="keyword">from</span> a <span class="keyword">LEFT</span> <span class="keyword">OUT</span> <span class="keyword">JOIN</span> b <span class="keyword">ON</span> a.a = b.c</span><br><span class="line">B：<span class="keyword">right</span> （<span class="keyword">outer</span>） <span class="keyword">join</span>:</span><br><span class="line">右外连接(右连接)：结果集既包括连接表的匹配连接行，也包括右连接表的所有行。</span><br><span class="line">C：<span class="keyword">full</span>/<span class="keyword">cross</span> （<span class="keyword">outer</span>） <span class="keyword">join</span>：</span><br><span class="line">全外连接：不仅包括符号连接表的匹配行，还包括两个连接表中的所有记录。</span><br><span class="line"><span class="number">12</span>、分组:<span class="keyword">Group</span> <span class="keyword">by</span>:</span><br><span class="line">  一张表，一旦分组完成后，查询后只能得到组相关的信息。</span><br><span class="line"> 组相关的信息：（统计信息） <span class="keyword">count</span>,<span class="keyword">sum</span>,<span class="keyword">max</span>,<span class="keyword">min</span>,<span class="keyword">avg</span>  分组的标准)</span><br><span class="line">    在SQLServer中分组时：不能以<span class="built_in">text</span>,ntext,image类型的字段作为分组依据</span><br><span class="line"> 在selecte统计函数中的字段，不能和普通的字段放在一起；</span><br><span class="line"><span class="number">13</span>、对数据库进行操作：</span><br><span class="line"> 分离数据库： sp_detach_db; 附加数据库：sp_attach_db 后接表明，附加需要完整的路径名</span><br><span class="line">14.如何修改数据库的名称:</span><br><span class="line">sp_renamedb 'old_name', 'new_name'</span><br></pre></td></tr></table></figure>
<h2 id="提升"><a href="#提升" class="headerlink" title="提升"></a>提升</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">1、说明：复制表(只复制结构,源表名：a 新表名：b) (Access可用)</span><br><span class="line">法一：<span class="keyword">select</span> * <span class="keyword">into</span> b <span class="keyword">from</span> a <span class="keyword">where</span> <span class="number">1</span>&lt;&gt;<span class="number">1</span>（仅用于SQlServer）</span><br><span class="line">法二：<span class="keyword">select</span> top <span class="number">0</span> * <span class="keyword">into</span> b <span class="keyword">from</span> a</span><br><span class="line"><span class="number">2</span>、说明：拷贝表(拷贝数据,源表名：a 目标表名：b) (<span class="keyword">Access</span>可用)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> b(a, b, c) <span class="keyword">select</span> d,e,f <span class="keyword">from</span> b;</span><br><span class="line">3、说明：跨数据库之间表的拷贝(具体数据使用绝对路径) (Access可用)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> b(a, b, c) <span class="keyword">select</span> d,e,f <span class="keyword">from</span> b <span class="keyword">in</span> ‘具体数据库’ <span class="keyword">where</span> 条件</span><br><span class="line">例子：..from b <span class="keyword">in</span> <span class="string">'"&amp;Server.MapPath(".")&amp;"\data.mdb" &amp;"'</span> where..</span><br><span class="line"><span class="number">4</span>、说明：子查询(表名<span class="number">1</span>：a 表名<span class="number">2</span>：b)</span><br><span class="line"><span class="keyword">select</span> a,b,c <span class="keyword">from</span> a <span class="keyword">where</span> a <span class="keyword">IN</span> (<span class="keyword">select</span> d <span class="keyword">from</span> b ) 或者: <span class="keyword">select</span> a,b,c <span class="keyword">from</span> a <span class="keyword">where</span> a <span class="keyword">IN</span> (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"><span class="number">5</span>、说明：显示文章、提交人和最后回复时间</span><br><span class="line"><span class="keyword">select</span> a.title,a.username,b.adddate <span class="keyword">from</span> <span class="keyword">table</span> a,(<span class="keyword">select</span> <span class="keyword">max</span>(adddate) adddate <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">where</span> table.title=a.title) b</span><br><span class="line"><span class="number">6</span>、说明：外连接查询(表名<span class="number">1</span>：a 表名<span class="number">2</span>：b)</span><br><span class="line"><span class="keyword">select</span> a.a, a.b, a.c, b.c, b.d, b.f <span class="keyword">from</span> a <span class="keyword">LEFT</span> <span class="keyword">OUT</span> <span class="keyword">JOIN</span> b <span class="keyword">ON</span> a.a = b.c</span><br><span class="line"><span class="number">7</span>、说明：在线视图查询(表名<span class="number">1</span>：a )</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> (<span class="keyword">SELECT</span> a,b,c <span class="keyword">FROM</span> a) T <span class="keyword">where</span> t.a &gt; <span class="number">1</span>;</span><br><span class="line">8、说明：between的用法,between限制查询数据范围时包括了边界值,not between不包括</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> table1 <span class="keyword">where</span> <span class="keyword">time</span> <span class="keyword">between</span> time1 <span class="keyword">and</span> time2</span><br><span class="line"><span class="keyword">select</span> a,b,c, <span class="keyword">from</span> table1 <span class="keyword">where</span> a <span class="keyword">not</span> <span class="keyword">between</span> 数值<span class="number">1</span> <span class="keyword">and</span> 数值<span class="number">2</span></span><br><span class="line"><span class="number">9</span>、说明：<span class="keyword">in</span> 的使用方法</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> table1 <span class="keyword">where</span> a [<span class="keyword">not</span>] <span class="keyword">in</span> (‘值<span class="number">1</span>’,’值<span class="number">2</span>’,’值<span class="number">4</span>’,’值<span class="number">6</span>’)</span><br><span class="line"><span class="number">10</span>、说明：两张关联表，删除主表中已经在副表中没有的信息</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> table1 <span class="keyword">where</span> <span class="keyword">not</span> <span class="keyword">exists</span> ( <span class="keyword">select</span> * <span class="keyword">from</span> table2 <span class="keyword">where</span> table1.field1=table2.field1 )</span><br><span class="line"><span class="number">11</span>、说明：四表联查问题：</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> a <span class="keyword">left</span> <span class="keyword">inner</span> <span class="keyword">join</span> b <span class="keyword">on</span> a.a=b.b <span class="keyword">right</span> <span class="keyword">inner</span> <span class="keyword">join</span> c <span class="keyword">on</span> a.a=c.c <span class="keyword">inner</span> <span class="keyword">join</span> d <span class="keyword">on</span> a.a=d.d <span class="keyword">where</span> .....</span><br><span class="line"><span class="number">12</span>、说明：日程安排提前五分钟提醒</span><br><span class="line"><span class="keyword">SQL</span>: <span class="keyword">select</span> * <span class="keyword">from</span> 日程安排 <span class="keyword">where</span> <span class="keyword">datediff</span>(<span class="string">'minute'</span>,f开始时间,<span class="keyword">getdate</span>())&gt;<span class="number">5</span></span><br><span class="line"><span class="number">13</span>、说明：一条<span class="keyword">sql</span> 语句搞定数据库分页</span><br><span class="line"><span class="keyword">select</span> top <span class="number">10</span> b.* <span class="keyword">from</span> (<span class="keyword">select</span> top <span class="number">20</span> 主键字段,排序字段 <span class="keyword">from</span> 表名 <span class="keyword">order</span> <span class="keyword">by</span> 排序字段 <span class="keyword">desc</span>) a,表名 b <span class="keyword">where</span> b.主键字段 = a.主键字段 <span class="keyword">order</span> <span class="keyword">by</span> a.排序字段</span><br><span class="line">具体实现：</span><br><span class="line">关于数据库分页：</span><br><span class="line">  <span class="keyword">declare</span> @<span class="keyword">start</span> <span class="built_in">int</span>,@<span class="keyword">end</span> <span class="built_in">int</span></span><br><span class="line">  @<span class="keyword">sql</span>  <span class="keyword">nvarchar</span>(<span class="number">600</span>)</span><br><span class="line">  <span class="keyword">set</span> @<span class="keyword">sql</span>=’<span class="keyword">select</span> top’+<span class="keyword">str</span>(@<span class="keyword">end</span>-@<span class="keyword">start</span>+<span class="number">1</span>)+’+<span class="keyword">from</span> T <span class="keyword">where</span> rid <span class="keyword">not</span> <span class="keyword">in</span>(<span class="keyword">select</span> top’+<span class="keyword">str</span>(@<span class="keyword">str</span><span class="number">-1</span>)+’Rid <span class="keyword">from</span> T <span class="keyword">where</span> Rid&gt;<span class="number">-1</span>)’</span><br><span class="line">  exec sp_executesql @<span class="keyword">sql</span></span><br><span class="line"> </span><br><span class="line">注意：在top后不能直接跟一个变量，所以在实际应用中只有这样的进行特殊的处理。Rid为一个标识列，如果top后还有具体的字段，这样做是非常有好处的。因为这样可以避免 </span><br><span class="line">top的字段如果是逻辑索引的，查询的结果后实际表中的不一致（逻辑索引中的数据有可能和数据表中的不一致，而查询时如果处在索引则首先查询索引）</span><br><span class="line"><span class="number">14</span>、说明：前<span class="number">10</span>条记录</span><br><span class="line"><span class="keyword">select</span> top <span class="number">10</span> * <span class="keyword">form</span> table1 <span class="keyword">where</span> 范围</span><br><span class="line"><span class="number">15</span>、说明：选择在每一组b值相同的数据中对应的a最大的记录的所有信息(类似这样的用法可以用于论坛每月排行榜,每月热销产品分析,按科目成绩排名,等等.)</span><br><span class="line"><span class="keyword">select</span> a,b,c <span class="keyword">from</span> tablename ta <span class="keyword">where</span> a=(<span class="keyword">select</span> <span class="keyword">max</span>(a) <span class="keyword">from</span> tablename tb <span class="keyword">where</span> tb.b=ta.b)</span><br><span class="line"><span class="number">16</span>、说明：包括所有在 TableA 中但不在 TableB和TableC 中的行并消除所有重复行而派生出一个结果表</span><br><span class="line">(<span class="keyword">select</span> a <span class="keyword">from</span> tableA ) <span class="keyword">except</span> (<span class="keyword">select</span> a <span class="keyword">from</span> tableB) <span class="keyword">except</span> (<span class="keyword">select</span> a <span class="keyword">from</span> tableC)</span><br><span class="line"><span class="number">17</span>、说明：随机取出<span class="number">10</span>条数据</span><br><span class="line"><span class="keyword">select</span> top <span class="number">10</span> * <span class="keyword">from</span> tablename <span class="keyword">order</span> <span class="keyword">by</span> newid()</span><br><span class="line"><span class="number">18</span>、说明：随机选择记录</span><br><span class="line"><span class="keyword">select</span> newid()</span><br><span class="line"><span class="number">19</span>、说明：删除重复记录</span><br><span class="line"><span class="number">1</span>),<span class="keyword">delete</span> <span class="keyword">from</span> tablename <span class="keyword">where</span> <span class="keyword">id</span> <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> <span class="keyword">max</span>(<span class="keyword">id</span>) <span class="keyword">from</span> tablename <span class="keyword">group</span> <span class="keyword">by</span> col1,col2,...)</span><br><span class="line"><span class="number">2</span>),<span class="keyword">select</span> <span class="keyword">distinct</span> * <span class="keyword">into</span> temp <span class="keyword">from</span> tablename</span><br><span class="line">  <span class="keyword">delete</span> <span class="keyword">from</span> tablename</span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> tablename <span class="keyword">select</span> * <span class="keyword">from</span> temp</span><br><span class="line">评价： 这种操作牵连大量的数据的移动，这种做法不适合大容量但数据操作</span><br><span class="line"><span class="number">3</span>),例如：在一个外部表中导入数据，由于某些原因第一次只导入了一部分，但很难判断具体位置，这样只有在下一次全部导入，这样也就产生好多重复的字段，怎样删除重复字段</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tablename</span><br><span class="line"><span class="comment">--添加一个自增列</span></span><br><span class="line"><span class="keyword">add</span>  column_b <span class="built_in">int</span> <span class="keyword">identity</span>(<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"> <span class="keyword">delete</span> <span class="keyword">from</span> tablename <span class="keyword">where</span> column_b <span class="keyword">not</span> <span class="keyword">in</span>(</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">max</span>(column_b)  <span class="keyword">from</span> tablename <span class="keyword">group</span> <span class="keyword">by</span> column1,column2,...)</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tablename <span class="keyword">drop</span> <span class="keyword">column</span> column_b</span><br><span class="line"><span class="number">20</span>、说明：列出数据库里所有的表名</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> sysobjects <span class="keyword">where</span> <span class="keyword">type</span>=<span class="string">'U'</span> // U代表用户</span><br><span class="line"><span class="number">21</span>、说明：列出表里的所有的列名</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> syscolumns <span class="keyword">where</span> <span class="keyword">id</span>=object_id(<span class="string">'TableName'</span>)</span><br><span class="line"><span class="number">22</span>、说明：列示<span class="keyword">type</span>、vender、pcs字段，以<span class="keyword">type</span>字段排列，<span class="keyword">case</span>可以方便地实现多重选择，类似<span class="keyword">select</span> 中的<span class="keyword">case</span>。</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">type</span>,<span class="keyword">sum</span>(<span class="keyword">case</span> vender <span class="keyword">when</span> <span class="string">'A'</span> <span class="keyword">then</span> pcs <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>),<span class="keyword">sum</span>(<span class="keyword">case</span> vender <span class="keyword">when</span> <span class="string">'C'</span> <span class="keyword">then</span> pcs <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>),<span class="keyword">sum</span>(<span class="keyword">case</span> vender <span class="keyword">when</span> <span class="string">'B'</span> </span><br><span class="line"><span class="keyword">then</span> pcs <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="keyword">FROM</span> tablename <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">type</span></span><br><span class="line">显示结果：</span><br><span class="line"><span class="keyword">type</span> vender pcs</span><br><span class="line">电脑 A <span class="number">1</span></span><br><span class="line">电脑 A <span class="number">1</span></span><br><span class="line">光盘 B <span class="number">2</span></span><br><span class="line">光盘 A <span class="number">2</span></span><br><span class="line">手机 B <span class="number">3</span></span><br><span class="line">手机 C <span class="number">3</span></span><br><span class="line"><span class="number">23</span>、说明：初始化表table1</span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> table1</span><br><span class="line"><span class="number">24</span>、说明：选择从<span class="number">10</span>到<span class="number">15</span>的记录</span><br><span class="line"><span class="keyword">select</span> top <span class="number">5</span> * <span class="keyword">from</span> (<span class="keyword">select</span> top <span class="number">15</span> * <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">id</span> <span class="keyword">asc</span>) table_别名 <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">id</span> <span class="keyword">desc</span></span><br></pre></td></tr></table></figure>
<h2 id="技巧"><a href="#技巧" class="headerlink" title="技巧"></a>技巧</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">1、1=1，1=2的使用，在SQL语句组合时用的较多</span><br><span class="line">“where 1=1” 是表示选择全部    “where 1=2”全部不选，</span><br><span class="line">如：</span><br><span class="line">if @strWhere !=''</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">set</span> @strSQL = <span class="string">'select count(*) as Total from ['</span> + @tblName + <span class="string">'] where '</span> + @strWhere</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">set</span> @strSQL = <span class="string">'select count(*) as Total from ['</span> + @tblName + <span class="string">']'</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">我们可以直接写成</span><br><span class="line">错误！未找到目录项。</span><br><span class="line"><span class="keyword">set</span> @strSQL = <span class="string">'select count(*) as Total from ['</span> + @tblName + <span class="string">'] where 1=1 安定 '</span>+ @strWhere <span class="number">2</span>、收缩数据库</span><br><span class="line"><span class="comment">--重建索引</span></span><br><span class="line">DBCC REINDEX</span><br><span class="line">DBCC INDEXDEFRAG</span><br><span class="line"><span class="comment">--收缩数据和日志</span></span><br><span class="line">DBCC SHRINKDB</span><br><span class="line">DBCC SHRINKFILE</span><br><span class="line"><span class="number">3</span>、压缩数据库</span><br><span class="line">dbcc shrinkdatabase(dbname)</span><br><span class="line"><span class="number">4</span>、转移数据库给新用户以已存在用户权限</span><br><span class="line">exec sp_change_users_login <span class="string">'update_one'</span>,<span class="string">'newname'</span>,<span class="string">'oldname'</span></span><br><span class="line"><span class="keyword">go</span></span><br><span class="line"><span class="number">5</span>、检查备份集</span><br><span class="line"><span class="keyword">RESTORE</span> VERIFYONLY <span class="keyword">from</span> disk=<span class="string">'E:\dvbbs.bak'</span></span><br><span class="line"><span class="number">6</span>、修复数据库</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">DATABASE</span> [dvbbs] <span class="keyword">SET</span> SINGLE_USER</span><br><span class="line"><span class="keyword">GO</span></span><br><span class="line">DBCC CHECKDB(<span class="string">'dvbbs'</span>,repair_allow_data_loss) <span class="keyword">WITH</span> TABLOCK</span><br><span class="line"><span class="keyword">GO</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">DATABASE</span> [dvbbs] <span class="keyword">SET</span> MULTI_USER</span><br><span class="line"><span class="keyword">GO</span></span><br><span class="line"><span class="number">7</span>、日志清除</span><br><span class="line"><span class="keyword">SET</span> NOCOUNT <span class="keyword">ON</span></span><br><span class="line"><span class="keyword">DECLARE</span> @LogicalFileName sysname,</span><br><span class="line"> @MaxMinutes <span class="built_in">INT</span>,</span><br><span class="line"> @NewSize <span class="built_in">INT</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">USE</span> tablename <span class="comment">-- 要操作的数据库名</span></span><br><span class="line"><span class="keyword">SELECT</span>  @LogicalFileName = <span class="string">'tablename_log'</span>, <span class="comment">-- 日志文件名</span></span><br><span class="line">@MaxMinutes = <span class="number">10</span>, <span class="comment">-- Limit on time allowed to wrap log.</span></span><br><span class="line"> @NewSize = <span class="number">1</span>  <span class="comment">-- 你想设定的日志文件的大小(M)</span></span><br><span class="line">Setup / initialize</span><br><span class="line"><span class="keyword">DECLARE</span> @OriginalSize <span class="built_in">int</span></span><br><span class="line"><span class="keyword">SELECT</span> @OriginalSize = <span class="keyword">size</span></span><br><span class="line"> <span class="keyword">FROM</span> sysfiles</span><br><span class="line"> <span class="keyword">WHERE</span> <span class="keyword">name</span> = @LogicalFileName</span><br><span class="line"><span class="keyword">SELECT</span> <span class="string">'Original Size of '</span> + db_name() + <span class="string">' LOG is '</span> +</span><br><span class="line"> <span class="keyword">CONVERT</span>(<span class="built_in">VARCHAR</span>(<span class="number">30</span>),@OriginalSize) + <span class="string">' 8K pages or '</span> +</span><br><span class="line"> <span class="keyword">CONVERT</span>(<span class="built_in">VARCHAR</span>(<span class="number">30</span>),(@OriginalSize*<span class="number">8</span>/<span class="number">1024</span>)) + <span class="string">'MB'</span></span><br><span class="line"> <span class="keyword">FROM</span> sysfiles</span><br><span class="line"> <span class="keyword">WHERE</span> <span class="keyword">name</span> = @LogicalFileName</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> DummyTrans</span><br><span class="line"> (DummyColumn <span class="built_in">char</span> (<span class="number">8000</span>) <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">DECLARE</span> @Counter    <span class="built_in">INT</span>,</span><br><span class="line"> @StartTime DATETIME,</span><br><span class="line"> @TruncLog   <span class="built_in">VARCHAR</span>(<span class="number">255</span>)</span><br><span class="line"><span class="keyword">SELECT</span> @StartTime = <span class="keyword">GETDATE</span>(),</span><br><span class="line"> @TruncLog = <span class="string">'BACKUP LOG '</span> + db_name() + <span class="string">' WITH TRUNCATE_ONLY'</span></span><br><span class="line">DBCC SHRINKFILE (@LogicalFileName, @NewSize)</span><br><span class="line">EXEC (@TruncLog)</span><br><span class="line"><span class="comment">-- Wrap the log if necessary.</span></span><br><span class="line"><span class="keyword">WHILE</span> @MaxMinutes &gt; <span class="keyword">DATEDIFF</span> (mi, @StartTime, <span class="keyword">GETDATE</span>()) <span class="comment">-- time has not expired</span></span><br><span class="line"> <span class="keyword">AND</span> @OriginalSize = (<span class="keyword">SELECT</span> <span class="keyword">size</span> <span class="keyword">FROM</span> sysfiles <span class="keyword">WHERE</span> <span class="keyword">name</span> = @LogicalFileName) </span><br><span class="line"> <span class="keyword">AND</span> (@OriginalSize * <span class="number">8</span> /<span class="number">1024</span>) &gt; @NewSize </span><br><span class="line"> <span class="keyword">BEGIN</span> <span class="comment">-- Outer loop.</span></span><br><span class="line"><span class="keyword">SELECT</span> @Counter = <span class="number">0</span></span><br><span class="line"> <span class="keyword">WHILE</span>   ((@Counter &lt; @OriginalSize / <span class="number">16</span>) <span class="keyword">AND</span> (@Counter &lt; <span class="number">50000</span>))</span><br><span class="line"> <span class="keyword">BEGIN</span> <span class="comment">-- update</span></span><br><span class="line"> <span class="keyword">INSERT</span> DummyTrans <span class="keyword">VALUES</span> (<span class="string">'Fill Log'</span>) <span class="keyword">DELETE</span> DummyTrans</span><br><span class="line"> <span class="keyword">SELECT</span> @Counter = @Counter + <span class="number">1</span></span><br><span class="line"> <span class="keyword">END</span></span><br><span class="line"> EXEC (@TruncLog) </span><br><span class="line"> <span class="keyword">END</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="string">'Final Size of '</span> + db_name() + <span class="string">' LOG is '</span> +</span><br><span class="line"> <span class="keyword">CONVERT</span>(<span class="built_in">VARCHAR</span>(<span class="number">30</span>),<span class="keyword">size</span>) + <span class="string">' 8K pages or '</span> +</span><br><span class="line"> <span class="keyword">CONVERT</span>(<span class="built_in">VARCHAR</span>(<span class="number">30</span>),(<span class="keyword">size</span>*<span class="number">8</span>/<span class="number">1024</span>)) + <span class="string">'MB'</span></span><br><span class="line"> <span class="keyword">FROM</span> sysfiles</span><br><span class="line"> <span class="keyword">WHERE</span> <span class="keyword">name</span> = @LogicalFileName</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> DummyTrans</span><br><span class="line"><span class="keyword">SET</span> NOCOUNT <span class="keyword">OFF</span></span><br><span class="line"><span class="number">8</span>、说明：更改某个表</span><br><span class="line">exec sp_changeobjectowner <span class="string">'tablename'</span>,<span class="string">'dbo'</span></span><br><span class="line"><span class="number">9</span>、存储更改全部表</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> dbo.User_ChangeObjectOwnerBatch</span><br><span class="line">@OldOwner <span class="keyword">as</span> <span class="keyword">NVARCHAR</span>(<span class="number">128</span>),</span><br><span class="line">@NewOwner <span class="keyword">as</span> <span class="keyword">NVARCHAR</span>(<span class="number">128</span>)</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">DECLARE</span> @<span class="keyword">Name</span>    <span class="keyword">as</span> <span class="keyword">NVARCHAR</span>(<span class="number">128</span>)</span><br><span class="line"><span class="keyword">DECLARE</span> @Owner   <span class="keyword">as</span> <span class="keyword">NVARCHAR</span>(<span class="number">128</span>)</span><br><span class="line"><span class="keyword">DECLARE</span> @OwnerName   <span class="keyword">as</span> <span class="keyword">NVARCHAR</span>(<span class="number">128</span>)</span><br><span class="line"><span class="keyword">DECLARE</span> curObject <span class="keyword">CURSOR</span> <span class="keyword">FOR</span></span><br><span class="line"><span class="keyword">select</span> <span class="string">'Name'</span>    = <span class="keyword">name</span>,</span><br><span class="line">   <span class="string">'Owner'</span>    = user_name(uid)</span><br><span class="line"><span class="keyword">from</span> sysobjects</span><br><span class="line"><span class="keyword">where</span> user_name(uid)=@OldOwner</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">name</span></span><br><span class="line"><span class="keyword">OPEN</span>   curObject</span><br><span class="line"><span class="keyword">FETCH</span> <span class="keyword">NEXT</span> <span class="keyword">FROM</span> curObject <span class="keyword">INTO</span> @<span class="keyword">Name</span>, @Owner</span><br><span class="line"><span class="keyword">WHILE</span>(@@FETCH_STATUS=<span class="number">0</span>)</span><br><span class="line"><span class="keyword">BEGIN</span>   </span><br><span class="line"><span class="keyword">if</span> @Owner=@OldOwner</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="keyword">set</span> @OwnerName = @OldOwner + <span class="string">'.'</span> + <span class="keyword">rtrim</span>(@<span class="keyword">Name</span>)</span><br><span class="line">   exec sp_changeobjectowner @OwnerName, @NewOwner</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">-- select @name,@NewOwner,@OldOwner</span></span><br><span class="line"><span class="keyword">FETCH</span> <span class="keyword">NEXT</span> <span class="keyword">FROM</span> curObject <span class="keyword">INTO</span> @<span class="keyword">Name</span>, @Owner</span><br><span class="line"><span class="keyword">END</span></span><br><span class="line"><span class="keyword">close</span> curObject</span><br><span class="line"><span class="keyword">deallocate</span> curObject</span><br><span class="line"><span class="keyword">GO</span></span><br><span class="line"> </span><br><span class="line"><span class="number">10</span>、<span class="keyword">SQL</span> <span class="keyword">SERVER</span>中直接循环写入数据</span><br><span class="line"><span class="keyword">declare</span> @i <span class="built_in">int</span></span><br><span class="line"><span class="keyword">set</span> @i=<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> @i&lt;<span class="number">30</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">test</span> (userid) <span class="keyword">values</span>(@i)</span><br><span class="line">    <span class="keyword">set</span> @i=@i+<span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">案例：</span><br><span class="line">有如下表，要求就裱中所有沒有及格的成績，在每次增長<span class="number">0.1</span>的基礎上，使他們剛好及格:</span><br><span class="line"> <span class="keyword">Name</span>     score</span><br><span class="line"> Zhangshan <span class="number">80</span></span><br><span class="line"> Lishi       <span class="number">59</span></span><br><span class="line"> Wangwu      <span class="number">50</span></span><br><span class="line"> Songquan <span class="number">69</span></span><br><span class="line"><span class="keyword">while</span>((<span class="keyword">select</span> <span class="keyword">min</span>(score) <span class="keyword">from</span> tb_table)&lt;<span class="number">60</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">update</span> tb_table <span class="keyword">set</span> score =score*<span class="number">1.01</span></span><br><span class="line"><span class="keyword">where</span> score&lt;<span class="number">60</span></span><br><span class="line"><span class="keyword">if</span>  (<span class="keyword">select</span> <span class="keyword">min</span>(score) <span class="keyword">from</span> tb_table)&gt;<span class="number">60</span></span><br><span class="line">  break</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line">    continue</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h2 id="数据开发"><a href="#数据开发" class="headerlink" title="数据开发"></a>数据开发</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">1.按姓氏笔画排序:</span><br><span class="line"><span class="keyword">Select</span> * <span class="keyword">From</span> TableName <span class="keyword">Order</span> <span class="keyword">By</span> CustomerName <span class="keyword">Collate</span> Chinese_PRC_Stroke_ci_as //从少到多</span><br><span class="line"><span class="number">2.</span>数据库加密:</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">encrypt</span>(<span class="string">'原始密码'</span>)</span><br><span class="line"><span class="keyword">select</span> pwdencrypt(<span class="string">'原始密码'</span>)</span><br><span class="line"><span class="keyword">select</span> pwdcompare(<span class="string">'原始密码'</span>,<span class="string">'加密后密码'</span>) = <span class="number">1</span><span class="comment">--相同；否则不相同 encrypt('原始密码')</span></span><br><span class="line"><span class="keyword">select</span> pwdencrypt(<span class="string">'原始密码'</span>)</span><br><span class="line"><span class="keyword">select</span> pwdcompare(<span class="string">'原始密码'</span>,<span class="string">'加密后密码'</span>) = <span class="number">1</span><span class="comment">--相同；否则不相同</span></span><br><span class="line"><span class="number">3.</span>取回表中字段:</span><br><span class="line"><span class="keyword">declare</span> @<span class="keyword">list</span> <span class="built_in">varchar</span>(<span class="number">1000</span>),</span><br><span class="line">@<span class="keyword">sql</span> <span class="keyword">nvarchar</span>(<span class="number">1000</span>)</span><br><span class="line"><span class="keyword">select</span> @<span class="keyword">list</span>=@<span class="keyword">list</span>+<span class="string">','</span>+b.name <span class="keyword">from</span> sysobjects a,syscolumns b <span class="keyword">where</span> a.id=b.id <span class="keyword">and</span> a.name=<span class="string">'表A'</span></span><br><span class="line"><span class="keyword">set</span> @<span class="keyword">sql</span>=<span class="string">'select '</span>+<span class="keyword">right</span>(@<span class="keyword">list</span>,<span class="keyword">len</span>(@<span class="keyword">list</span>)<span class="number">-1</span>)+<span class="string">' from 表A'</span></span><br><span class="line">exec (@<span class="keyword">sql</span>)</span><br><span class="line"><span class="number">4.</span>查看硬盘分区:</span><br><span class="line">EXEC master..xp_fixeddrives</span><br><span class="line"><span class="number">5.</span>比较A,B表是否相等:</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">select</span> <span class="keyword">checksum_agg</span>(binary_checksum(*)) <span class="keyword">from</span> A)</span><br><span class="line">     =</span><br><span class="line">    (<span class="keyword">select</span> <span class="keyword">checksum_agg</span>(binary_checksum(*)) <span class="keyword">from</span> B)</span><br><span class="line">print <span class="string">'相等'</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">print <span class="string">'不相等'</span></span><br><span class="line"><span class="number">6.</span>杀掉所有的事件探察器进程:</span><br><span class="line"><span class="keyword">DECLARE</span> hcforeach <span class="keyword">CURSOR</span> <span class="keyword">GLOBAL</span> <span class="keyword">FOR</span> <span class="keyword">SELECT</span> <span class="string">'kill '</span>+<span class="keyword">RTRIM</span>(spid) <span class="keyword">FROM</span> master.dbo.sysprocesses</span><br><span class="line"><span class="keyword">WHERE</span> program_name <span class="keyword">IN</span>(<span class="string">'SQL profiler'</span>,N<span class="string">'SQL 事件探查器'</span>)</span><br><span class="line">EXEC sp_msforeach_worker <span class="string">'?'</span></span><br><span class="line"><span class="number">7.</span>记录搜索:</span><br><span class="line">开头到N条记录</span><br><span class="line"><span class="keyword">Select</span> Top N * <span class="keyword">From</span> 表</span><br><span class="line"><span class="comment">-------------------------------</span></span><br><span class="line">N到M条记录(要有主索引<span class="keyword">ID</span>)</span><br><span class="line"><span class="keyword">Select</span> Top M-N * <span class="keyword">From</span> 表 <span class="keyword">Where</span> <span class="keyword">ID</span> <span class="keyword">in</span> (<span class="keyword">Select</span> Top M <span class="keyword">ID</span> <span class="keyword">From</span> 表) <span class="keyword">Order</span> <span class="keyword">by</span> <span class="keyword">ID</span>   <span class="keyword">Desc</span></span><br><span class="line"><span class="comment">----------------------------------</span></span><br><span class="line">N到结尾记录</span><br><span class="line"><span class="keyword">Select</span> Top N * <span class="keyword">From</span> 表 <span class="keyword">Order</span> <span class="keyword">by</span> <span class="keyword">ID</span> <span class="keyword">Desc</span></span><br><span class="line">案例</span><br><span class="line">例如<span class="number">1</span>：一张表有一万多条记录，表的第一个字段 RecID 是自增长字段， 写一个<span class="keyword">SQL</span>语句，找出表的第<span class="number">31</span>到第<span class="number">40</span>个记录。</span><br><span class="line"> <span class="keyword">select</span> top <span class="number">10</span> recid <span class="keyword">from</span> A <span class="keyword">where</span> recid <span class="keyword">not</span>  <span class="keyword">in</span>(<span class="keyword">select</span> top <span class="number">30</span> recid <span class="keyword">from</span> A)</span><br><span class="line">分析：如果这样写会产生某些问题，如果recid在表中存在逻辑索引。</span><br><span class="line"> <span class="keyword">select</span> top <span class="number">10</span> recid <span class="keyword">from</span> A <span class="keyword">where</span>……是从索引中查找，而后面的<span class="keyword">select</span> top <span class="number">30</span> recid <span class="keyword">from</span> A 则在数据表中查找，这样由于索引中的顺序有可能和数据表中的不一致，</span><br><span class="line">这样就导致查询到的不是本来的欲得到的数据。</span><br><span class="line"></span><br><span class="line">解决方案</span><br><span class="line"><span class="number">1</span>， 用<span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">select</span> top <span class="number">30</span> recid <span class="keyword">from</span> A <span class="keyword">order</span> <span class="keyword">by</span> ricid 如果该字段不是自增长，就会出现问题</span><br><span class="line"><span class="number">2</span>， 在那个子查询中也加条件：<span class="keyword">select</span> top <span class="number">30</span> recid <span class="keyword">from</span> A <span class="keyword">where</span> recid&gt;<span class="number">-1</span></span><br><span class="line">例<span class="number">2</span>：查询表中的最后以条记录，并不知道这个表共有多少数据,以及表结构。</span><br><span class="line"><span class="keyword">set</span> @s = <span class="string">'select top 1 * from T   where pid not in (select top '</span> + <span class="keyword">str</span>(@<span class="keyword">count</span><span class="number">-1</span>) + <span class="string">' pid  from  T)'</span></span><br><span class="line">print @s      exec  sp_executesql  @s</span><br><span class="line"><span class="number">9</span>：获取当前数据库中的所有用户表</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">Name</span> <span class="keyword">from</span> sysobjects <span class="keyword">where</span> xtype=<span class="string">'u'</span> <span class="keyword">and</span> <span class="keyword">status</span>&gt;=<span class="number">0</span></span><br><span class="line"><span class="number">10</span>：获取某一个表的所有字段</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> syscolumns <span class="keyword">where</span> <span class="keyword">id</span>=object_id(<span class="string">'表名'</span>)</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> syscolumns <span class="keyword">where</span> <span class="keyword">id</span> <span class="keyword">in</span> (<span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> sysobjects <span class="keyword">where</span> <span class="keyword">type</span> = <span class="string">'u'</span> <span class="keyword">and</span> <span class="keyword">name</span> = <span class="string">'表名'</span>)</span><br><span class="line">两种方式的效果相同</span><br><span class="line"><span class="number">11</span>：查看与某一个表相关的视图、存储过程、函数</span><br><span class="line"><span class="keyword">select</span> a.* <span class="keyword">from</span> sysobjects a, syscomments b <span class="keyword">where</span> a.id = b.id <span class="keyword">and</span> b.text <span class="keyword">like</span> <span class="string">'%表名%'</span></span><br><span class="line"><span class="number">12</span>：查看当前数据库中所有存储过程</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">as</span> 存储过程名称 <span class="keyword">from</span> sysobjects <span class="keyword">where</span> xtype=<span class="string">'P'</span></span><br><span class="line"><span class="number">13</span>：查询用户创建的所有数据库</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> master..sysdatabases D <span class="keyword">where</span> <span class="keyword">sid</span> <span class="keyword">not</span> <span class="keyword">in</span>(<span class="keyword">select</span> <span class="keyword">sid</span> <span class="keyword">from</span> master..syslogins <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'sa'</span>)</span><br><span class="line">或者</span><br><span class="line"><span class="keyword">select</span> dbid, <span class="keyword">name</span> <span class="keyword">AS</span> DB_NAME <span class="keyword">from</span> master..sysdatabases <span class="keyword">where</span> <span class="keyword">sid</span> &lt;&gt; <span class="number">0x01</span></span><br><span class="line"><span class="number">14</span>：查询某一个表的字段和数据类型</span><br><span class="line"><span class="keyword">select</span> column_name,data_type <span class="keyword">from</span> information_schema.columns</span><br><span class="line"><span class="keyword">where</span> table_name = <span class="string">'表名'</span></span><br><span class="line"><span class="number">15</span>：不同服务器数据库之间的数据操作</span><br><span class="line"><span class="comment">--创建链接服务器</span></span><br><span class="line">exec sp_addlinkedserver   <span class="string">'ITSV '</span>, <span class="string">' '</span>, <span class="string">'SQLOLEDB '</span>, <span class="string">'远程服务器名或ip地址 '</span></span><br><span class="line">exec sp_addlinkedsrvlogin  <span class="string">'ITSV '</span>, <span class="string">'false '</span>,<span class="literal">null</span>, <span class="string">'用户名 '</span>, <span class="string">'密码 '</span></span><br><span class="line"><span class="comment">--查询示例</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> ITSV.数据库名.dbo.表名</span><br><span class="line"><span class="comment">--导入示例</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">into</span> 表 <span class="keyword">from</span> ITSV.数据库名.dbo.表名</span><br><span class="line"><span class="comment">--以后不再使用时删除链接服务器</span></span><br><span class="line">exec sp_dropserver  <span class="string">'ITSV '</span>, <span class="string">'droplogins '</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">--连接远程/局域网数据(openrowset/openquery/opendatasource)</span></span><br><span class="line"><span class="comment">--1、openrowset</span></span><br><span class="line"><span class="comment">--查询示例</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> openrowset( <span class="string">'SQLOLEDB '</span>, <span class="string">'sql服务器名 '</span>; '用户名 '; '密码 ',数据库名.dbo.表名)</span><br><span class="line"><span class="comment">--生成本地表</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">into</span> 表 <span class="keyword">from</span> openrowset( <span class="string">'SQLOLEDB '</span>, <span class="string">'sql服务器名 '</span>; '用户名 '; '密码 ',数据库名.dbo.表名)</span><br><span class="line"> </span><br><span class="line"><span class="comment">--把本地表导入远程表</span></span><br><span class="line"><span class="keyword">insert</span> openrowset( <span class="string">'SQLOLEDB '</span>, <span class="string">'sql服务器名 '</span>; '用户名 '; '密码 ',数据库名.dbo.表名)</span><br><span class="line"><span class="keyword">select</span> *<span class="keyword">from</span> 本地表</span><br><span class="line"><span class="comment">--更新本地表</span></span><br><span class="line"><span class="keyword">update</span> b</span><br><span class="line"><span class="keyword">set</span> b.列A=a.列A</span><br><span class="line"> <span class="keyword">from</span> openrowset( <span class="string">'SQLOLEDB '</span>, <span class="string">'sql服务器名 '</span>; '用户名 '; '密码 ',数据库名.dbo.表名)as a inner join 本地表 b</span><br><span class="line">on a.column1=b.column1</span><br><span class="line"><span class="comment">--openquery用法需要创建一个连接</span></span><br><span class="line"><span class="comment">--首先创建一个连接创建链接服务器</span></span><br><span class="line">exec sp_addlinkedserver   'ITSV ', ' ', 'SQLOLEDB ', '远程服务器名或ip地址 '</span><br><span class="line"><span class="comment">--查询</span></span><br><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">FROM</span> openquery(ITSV,  <span class="string">'SELECT *  FROM 数据库.dbo.表名 '</span>)</span><br><span class="line"><span class="comment">--把本地表导入远程表</span></span><br><span class="line"><span class="keyword">insert</span> openquery(ITSV,  <span class="string">'SELECT *  FROM 数据库.dbo.表名 '</span>)</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> 本地表</span><br><span class="line"><span class="comment">--更新本地表</span></span><br><span class="line"><span class="keyword">update</span> b</span><br><span class="line"><span class="keyword">set</span> b.列B=a.列B</span><br><span class="line"><span class="keyword">FROM</span> openquery(ITSV,  <span class="string">'SELECT * FROM 数据库.dbo.表名 '</span>) <span class="keyword">as</span> a </span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> 本地表 b <span class="keyword">on</span> a.列A=b.列A</span><br><span class="line"> </span><br><span class="line"><span class="comment">--3、opendatasource/openrowset</span></span><br><span class="line"><span class="keyword">SELECT</span>   *</span><br><span class="line"><span class="keyword">FROM</span>   opendatasource( <span class="string">'SQLOLEDB '</span>,  <span class="string">'Data Source=ip/ServerName;User ID=登陆名;Password=密码 '</span> ).test.dbo.roy_ta</span><br><span class="line"><span class="comment">--把本地表导入远程表</span></span><br><span class="line"><span class="keyword">insert</span> opendatasource( <span class="string">'SQLOLEDB '</span>,  <span class="string">'Data Source=ip/ServerName;User ID=登陆名;Password=密码 '</span>).数据库.dbo.表名</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> 本地表</span><br></pre></td></tr></table></figure>
<h1 id="PowerDesigner设计建造MySQL数据库"><a href="#PowerDesigner设计建造MySQL数据库" class="headerlink" title="PowerDesigner设计建造MySQL数据库"></a>PowerDesigner设计建造MySQL数据库</h1><h2 id="制作建库脚本"><a href="#制作建库脚本" class="headerlink" title="制作建库脚本"></a>制作建库脚本</h2><ol>
<li>设计CDM(Conceptual Data Model)</li>
<li>选择 Tools -&gt; Generate Physical Data Model ，选择对应的DBMS为MySQL，生成PDM</li>
<li>选择 Database -&gt; Generate Database ，在弹出的 Database Generation 对话框中选择脚本存取路径及脚本文件名称</li>
<li>点击确定后生成数据库建库脚本(*.sql)</li>
</ol>
<h2 id="执行sql脚本"><a href="#执行sql脚本" class="headerlink" title="执行sql脚本"></a>执行sql脚本</h2><h3 id="第一种方法"><a href="#第一种方法" class="headerlink" title="第一种方法:"></a>第一种方法:</h3><p>在命令行下(未连接数据库),输入 mysql -h localhost -u root -p123456 &lt; F:/mytest/testdb.sql (注意路径不用加引号的!!) 回车即可. </p>
<h3 id="第二种方法"><a href="#第二种方法" class="headerlink" title="第二种方法:"></a>第二种方法:</h3><p>在命令行下(已连接数据库,此时的提示符为 mysql&gt; ),输入 source F:/mytest/testdb.sql (注意路径不用加引号的) 回车即可</p>
<h1 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h1><h2 id="JDBC概念"><a href="#JDBC概念" class="headerlink" title="JDBC概念"></a>JDBC概念</h2><p>JDBC（Java DataBase Connectivity,java数据库连接）是一种用于执行SQL语句的Java API，可以为多种关系数据库提供统一访问，它由一组用Java语言编写的类和接口组成。JDBC提供了一种基准，据此可以构建更高级的工具和接口，使数据库开发人员能够编写数据库应用程序。</p>
<h2 id="一、JDBC常用接口、类介绍"><a href="#一、JDBC常用接口、类介绍" class="headerlink" title="一、JDBC常用接口、类介绍"></a>一、JDBC常用接口、类介绍</h2><p>JDBC提供对独立于数据库统一的API，用以执行SQL命令。API常用的类、接口如下：</p>
<h3 id="DriverManager"><a href="#DriverManager" class="headerlink" title="DriverManager"></a><strong>DriverManager</strong></h3><p>管理JDBC驱动的服务类，主要通过它获取Connection数据库链接，常用方法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Connection <span class="title">getConnection</span><span class="params">(String url, String user, String password)</span> <span class="keyword">throws</span> Exception</span>;</span><br></pre></td></tr></table></figure>
<p>该方法获得url对应的数据库的连接。</p>
<h3 id="Connection常用数据库操作方法："><a href="#Connection常用数据库操作方法：" class="headerlink" title="Connection常用数据库操作方法："></a><strong>Connection</strong>常用数据库操作方法：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Statement createStatement <span class="keyword">throws</span> SQLException: <span class="comment">//该方法返回一个Statement对象。</span></span><br><span class="line"></span><br><span class="line"><span class="function">PreparedStatement <span class="title">prepareStatement</span><span class="params">(String sql)</span> <span class="keyword">throws</span> SQLException</span>;<span class="comment">//该方法返回预编译的Statement对象， 即将SQL语句提交到数据库进行预编译。</span></span><br><span class="line"></span><br><span class="line"><span class="function">CallableStatement <span class="title">prepareCall</span><span class="params">(String sql)</span> <span class="keyword">throws</span> SQLException：<span class="comment">//该方法返回CallableStatement对象，该对象用于存储过程的调用。</span></span></span><br></pre></td></tr></table></figure>
<p>上面的三个方法都是返回执行SQL语句的Statement对象，PreparedStatement、CallableStatement的对象是Statement的子类，只有获得Statement之后才可以执行SQL语句。</p>
<h3 id="Connection控制事务"><a href="#Connection控制事务" class="headerlink" title="Connection控制事务"></a>Connection控制事务</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Savepoint <span class="title">setSavepoint</span><span class="params">()</span>: <span class="comment">//创建一个保存点</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">Savepoint <span class="title">setSavepoint</span><span class="params">(String name)</span>：<span class="comment">//创建一个带有名称的保存点</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setTransactionIsolation</span><span class="params">(<span class="keyword">int</span> level)</span>:<span class="comment">//设置事务隔离级别</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rollback</span><span class="params">()</span>：<span class="comment">//回滚事务</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rollback</span><span class="params">(Savepoint savepoint)</span>：<span class="comment">//回滚到指定保存点</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setAutoCommit</span><span class="params">(<span class="keyword">boolean</span> autoCommit)</span>: <span class="comment">//关闭自动提交，打开事务</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">commit</span><span class="params">()</span>：提交事务</span></span><br></pre></td></tr></table></figure>
<h3 id="Statement"><a href="#Statement" class="headerlink" title="Statement"></a><strong>Statement</strong></h3><p>用于执行SQL语句的API接口，该对象可以执行DDL、DCL语句，也可以执行DML语句，还可以执行SQL查询语句，当执行查询语句是返回结果集，常用方法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ResultSet <span class="title">executeQuery</span><span class="params">(String sql)</span> <span class="keyword">throws</span> SQLException：<span class="comment">//该方法用于执行查询语句，并返回查询结果对应的ResultSet对象，该方法只用于查询语句。</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">executeUpdate</span><span class="params">(String sql)</span> <span class="keyword">throws</span> SQLException：<span class="comment">//该方法用于执行DML语句，并返回受影响的行数；该方法也可以执行DDL，执行DDL返回0；</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">execute</span><span class="params">(String sql)</span> <span class="keyword">throws</span> SQLException：<span class="comment">//该方法可以执行任何SQL语句，如果执行后第一个结果是ResultSet对象，则返回true；如果执行后第一个结果为受影响的行数或没有任何结果，则返回false；</span></span></span><br></pre></td></tr></table></figure>
<h3 id="PreparedStatement"><a href="#PreparedStatement" class="headerlink" title="PreparedStatement"></a><strong>PreparedStatement</strong></h3><p>预编译的statement对象，PreparedStatement是Statement的子接口，它允许数据库预编译SQL（通常指带参数SQL）语句，以后每次只改变SQL命令参数，避免数据库每次都编译SQL语句，这样性能就比较好。而相对于Statement而言，使用PreparedStatement执行SQL语句时，无需重新传入SQL语句，因为它已经预编译了SQL语句。</p>
<p>但是PreparedStatement需要为编译的SQL语句传入参数值，所以它比了如下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void setXxx(int index, value)//根据该方法传入的参数值的类型不同，需要使用不同的方法。</span><br></pre></td></tr></table></figure>
<p>传入的值的类型根据传入的SQL语句参数而定。</p>
<h3 id="ResultSet"><a href="#ResultSet" class="headerlink" title="ResultSet"></a><strong>ResultSet</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> <span class="keyword">throws</span> SQLException：<span class="comment">//释放、关闭ResultSet对象</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">absolute</span><span class="params">(<span class="keyword">int</span> row)</span>:<span class="comment">//将结果集移动到第几行，如果row是负数，则移动到倒数第几行。如果移动到的记录指针指向一条有效记录，则该方法返回true；</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">beforeFisrt</span><span class="params">()</span>: <span class="comment">//将ResultSet的记录指针定位到首行之前，这是ResultSet结果集记录指针的初始状态：记录指针的起始位置位于第一行之前。</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">first</span><span class="params">()</span>：<span class="comment">//将ResultSet的记录指针定位到首行。如果移动后的记录指针指向一条有效记录，则该方法返回true。</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">previous</span><span class="params">()</span>：<span class="comment">//将ResultSet的记录指针定位到上一行，如果移动后的记录指针指向一条有效记录，则该方法返回true。</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">next</span><span class="params">()</span>：<span class="comment">//将ResultSet的记录指针定位到下一行。如果移动后的记录指针指向一条有效记录，则返回true。</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">last</span><span class="params">()</span>：<span class="comment">//将ResultSet的记录指针定位到最后一行。如果移动后的记录指针指向一条有效记录，则返回true。</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">afterLast</span><span class="params">()</span>：<span class="comment">//将ResultSet的记录指针定位到最后一行之后。</span></span></span><br></pre></td></tr></table></figure>
<p>注意：在JDK1.4以前只支持next移动，且每次移动一个位置。到JDK1.5就可以随意定位。</p>
<h2 id="二、JDBC编程步骤"><a href="#二、JDBC编程步骤" class="headerlink" title="二、JDBC编程步骤"></a>二、JDBC编程步骤</h2><p>进行jdbc编程步骤大致如下：</p>
<ol>
<li>加载数据库驱动</li>
</ol>
<p>Class.forName(driverClass)<br>上面的dirverClass就是数据库驱动类所对应的类路径字符串，根据不同数据库厂商提供的驱动也不同。</p>
<ol start="2">
<li>通过DriverManager获取数据库的链接</li>
</ol>
<p>DriverManager.getConnection(String url, Stirng user, String pass)<br>当使用DriverManager来获取链接，需要传入三个参数：分别是数据量的url、用户名、密码。</p>
<ol start="3">
<li>通过Connection对象创建Statement对象，Connection创建Statement的方法如下三个：</li>
</ol>
<p>createStatement()创建基本的Statement对象。<br>prepareStatement(String sql)：根据传入的sql语句创建预编译的Statement对象。<br>prepareCall(String sql)：根据传入的sql语句创建CallableStatement对象</p>
<ol start="4">
<li>Statement执行SQL语句，Statement有三大方法来执行SQL语句：</li>
</ol>
<p>execute：可以执行任何SQL语句，单比较麻烦<br>executeUpdate：可以执行DML、DDL语句。执行DML返回受影响的SQL语句行数，执行DDL返回0；<br>executeQuery：只能执行查询语句，执行后返回代表查询结果的ResultSet对象。</p>
<ol start="5">
<li>操作结果集，针对ResultSet</li>
</ol>
<p>主要移动指针和获得值</p>
<p>next、previous、first、last、beforeFrist、afterLast、absolute等移动指针的方法。</p>
<p>getXxx获得移动指针指向行，特定列、索引的值。使用列名作为获取值的参数可读性好、使用索引作为获取参数性能好。</p>
<h2 id="三、JDBC执行SQL语句"><a href="#三、JDBC执行SQL语句" class="headerlink" title="三、JDBC执行SQL语句"></a>三、JDBC执行SQL语句</h2><ol>
<li>executeUpdate执行DDL、DML语句</li>
</ol>
<p>Statement提供了execute、executeUpdate、executeQuery三种方法执行，下面用executeUpdate来执行DDL、DML语句，executeUpdate执行DDL返回值是0，执行了DML是返回影响后的记录条数。</p>
<ol start="2">
<li>execute执行SQL语句</li>
</ol>
<p>当我们知道SQL语句是完成修改语句时，我们就知道使用executeUpdate语句来完成操作；如果SQL语句是完成查询操作的时候，我们就使用executeQuery来完成。</p>
<p>如果我们不知道SQL语句完成什么操作的时候，就可以使用execute方法来完成。</p>
<p>当我们使用Statement对象的execute方法执行SQL语句后返回的是boolean值，这就说明该语句能否返回ResultSet对象。</p>
<p>那么，如何判断是否是ResultSet对象？方法如下：</p>
<p>getResultSet()：获取该Statement执行查询语句返回的ResultSet对象</p>
<p>getUpdateCount()：获取该Statement执行修改语句影响的行数</p>
<ol start="3">
<li>PrepareStatement执行SQL语句</li>
</ol>
<p>对于我们操作数据库的时候，执行某一条SQL语句的时候。只有它的参数不同，而SQL语句相同。</p>
<p>我们可以使用占位符来设置我们的参数信息，PrepareStatement中的占位符是？，用？代替参数的位置。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">table</span> <span class="keyword">values</span>(?, ‘abc’, ?);</span><br></pre></td></tr></table></figure>
<p>占位符仅仅支持PrepareStatement，而Statement不支持占位符。PrepareStatement是预编译SQL语句的，然后将占位符替换成参数。而Statement就不能做到。</p>
<p>PrepareStatement对象也有execute、executeUpdate、executeQuery这三个方法，但这三个方法都无需传递参数。只需用PrepareStatement来设置占位符的参数，通过用setXxxx(index, value)来完成设置参数信息即可。PrepareStatement的效率要比Statement的效率高。PrepareStatement设置参数可以不拼接字符串，而Statement设置参数信息的时候需要手动拼接字符串。拼接字符串容易操作程序错误、可读性降低、维护性升高、程序性能下降。而PrepareStatement直接设置参数信息就降低了编程的复杂度。并且它可以放在SQL注入。因为它是通过setXxx方法进行设置参数信息，而Statement是通过拼接字符串，很容易就造成SQL注入。</p>
<p>综上所述，PrepareStatement比Statement有以下优点：</p>
<ul>
<li>预编译SQL语句，性能更好</li>
<li>无需拼接SQL语句，编程更简单</li>
<li>可以防止SQL语句注入，安全性更好</li>
</ul>
<ol start="4">
<li>CallableStatement调用存储过程</li>
</ol>
<p>存储过程的调用可以通过CallableStatement，通过Connection对象的prepareCall方法来创建CallableStatement对象。</p>
<p>然后传入存储过程的SQL语句，即可调用存储过程，格式如下：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;call proc_name(?, ?, ?)&#125;</span><br></pre></td></tr></table></figure>
<p>上面的?是占位符，表示传递的参数。</p>
<p>存储过程有传入参数、传出参数。传入参数是程程序必须传入的参数，可以 通过setXxx方法进行设置参数值。</p>
<p>而传出参数则需要通过程序进行设置，可以用CallableStatement对象的registerOutParameter方法来注册输出参数，cs.registerOutParameter(3, Types.STRING);</p>
<p>设置完毕后，当调用存储过程后要获取输出参数值，可以通过getXxx方法来完成。</p>
<h2 id="四、操作结果集-ResultSet"><a href="#四、操作结果集-ResultSet" class="headerlink" title="四、操作结果集(ResultSet)"></a>四、操作结果集(ResultSet)</h2><p>JDBC是通过ResultSet来管理结果集，操作ResultSet可以通过移动其指针来指向不同的行记录，然后取出当前记录即可。并且ResultSet可以完成更新记录，还提供了ResultSetMetaData来获得对象相关信息。</p>
<ol>
<li>可移动、可更新的ResultSet</li>
</ol>
<p>前面介绍过ResultSet的相关方法，可以通过一系列的方法来移动记录指针，如：absolute、previous、next、first、last、beforeFirst、afterLast等方法。</p>
<p>ResultSet默认是不支持更新的，如果希望ResultSet完成更新操作，必须在创建Statement或PrepareStatement时传入一些参数。</p>
<p>Connection对象在创建Statement或PrepareStatement时可以传入两个参数：</p>
<h3 id="resultSetType：控制ResultSet的类型，该参数有以下三个值："><a href="#resultSetType：控制ResultSet的类型，该参数有以下三个值：" class="headerlink" title="resultSetType：控制ResultSet的类型，该参数有以下三个值："></a>resultSetType：控制ResultSet的类型，该参数有以下三个值：</h3><ul>
<li>ResultSet.TYPE_FORWARD_ONLY该常量控制记录指针只能向前移动。Jdk1.4的默认值</li>
<li>ResultSet.TYPE_SCROLL_INSENSITIVE：该常量控制记录指针自由移动(可滚动结果集)，但底层的数据改变不影响结果集ResultSet的内容</li>
<li>ResultSet.TYPE_SCROLL_SENSITIVE：该常量控制记录指针自由移动，但底层数据的影响会改变结果集ResultSet的内容</li>
</ul>
<h3 id="resultSetConcurrency：控制ResultSet的并发类型，该参数可以接收如下两个值："><a href="#resultSetConcurrency：控制ResultSet的并发类型，该参数可以接收如下两个值：" class="headerlink" title="resultSetConcurrency：控制ResultSet的并发类型，该参数可以接收如下两个值："></a>resultSetConcurrency：控制ResultSet的并发类型，该参数可以接收如下两个值：</h3><ul>
<li>ResultSet.CONCUR_READ_ONLY：该常量表示ResultSet是只读并发模式</li>
<li>ResultSet.CONCUR_UPDATABLE：该常量表示ResultSet是更新并发模式</li>
</ul>
<p>通过PrepareStatement、Statement的创建时进行参数设置来创建可滚动、可更新的ResultSet，然后通过rs的updateXxx方法来完成某列的更新值设置，通过updateRow来提交修改。</p>
<ol start="2">
<li>ResultSet中的二进制Blob数据处理</li>
</ol>
<p>Blob类型通常用来存储文件，如：图片、音频、视频文件。将文件转换成二进制保存在数据库中，取出来的时候可以二进制数据恢复成文件。</p>
<p>如果要插入图片到数据库，显然不能直接设置SQL参数拼接字符串进行插入。因为二进制常量无法表示。</p>
<p>但是将Blob类型数据插入到数据可以用PrepareStatement，通过PrepareStatement对象的setBinaryStatement方法将参数传入到二进制输入流；也可以用Blob对象的getBytes方法直接取出数据。</p>
<ol start="3">
<li>利用ResultSetMetaData操作ResultSet结果集</li>
</ol>
<p>在我们查询数据返回的结果集中，我们不清楚结果集存放的数据类型、数据列数。</p>
<p>那样我们就可以用ResultSetMetaData来读取ResultSet的信息。</p>
<p>通过ResultSet的getMetaData()的方法可以获取ResultSetMetaData对象。</p>
<p>然后可以用ResultSetMetaData对象的方法来操作ResultSet，常用方法如下：</p>
<ul>
<li>int getColumnCount()：返回ResultSet的列名数量</li>
<li>int getColumnType(int column)：返回指定索引的类型</li>
<li>String getColumnName(int column)：返回指定索引的列名</li>
</ul>
<h2 id="五、JDBC事务"><a href="#五、JDBC事务" class="headerlink" title="五、JDBC事务"></a>五、JDBC事务</h2><ol>
<li>事务介绍</li>
</ol>
<p>事务是一步或多步组成操作序列组成的逻辑执行单元，这个序列要么全部执行，要么则全部放弃执行。</p>
<p>事务的四个特性：原子性（Atomicity）、一致性（Consistency）、隔离性（IsoIation）和持续性（Durability）</p>
<ul>
<li><p>原子性（<strong><strong>Atomicity</strong></strong>）：事务应用最小的执行单元，不可再分。是事务中不可再分的最小逻辑执行体。</p>
</li>
<li><p>一致性（<strong><strong>Consistency</strong></strong>）：事务的执行结果，必须使数据库的从一个一致性的状态变到另一个一致性的状态。</p>
</li>
<li><p>隔离线（<strong><strong>IsoIation</strong></strong>）：各个事务的执行互不干扰，任意一个事务的内部操作对其他并发的事务，都是隔离的。也就是：并发执行的事务之间不能看到对方的中间状态，并发执行的事务之间不能互相影响。</p>
</li>
<li><p>持续性（<strong><strong>Durability</strong></strong>）：持续性也称为持久性（Persistence），指事务一旦提交，对数据所做的任何改变，都要记录到永久存储器中，通常就是保存在物理数据库中。</p>
</li>
</ul>
<p>通常数据库的事务涉及到的语句有：</p>
<p>一组DML（Data Munipulation Language，数据操作语言）语句，这组DML语句修改后数据将保持较好的一致性；</p>
<p>操作表的语句，如插入、修改、删除等；</p>
<p>一个DDL（Data Definition Language，数据定义语言）语句，操作数据对象的语言，有create、alter、drop。</p>
<p>一个DCL（Data Control Language，数据控制语言）语句，主要有grant、revoke语句。</p>
<p>DDL和DCL语句最多只能有一个，因为它们都会导致事务的立即提交。</p>
<p>当事务所包含的全部数据库操作都成功执行后，应该提交事务，使这些修改永久生效。</p>
<p>事务提交有两种方式：显示提交和自动提交。</p>
<p>显示提交：使用commit提交</p>
<p>自动提交：执行DLL或DCL，或者程序正常退出</p>
<p>当事务包含的任意一个数据库操作执行失败后，应该回滚（rollback）事务，使该事务中所作的修改全部失效。</p>
<p>事务的回滚方式有两种：显示回滚和自动回滚。</p>
<p>显示回滚：使用rollback</p>
<p>自动回滚：系统错误或强行退出</p>
<ol start="2">
<li>JDBC的事物的支持</li>
</ol>
<p>JDBC的Connection也支持事物，Connection默认打开自动提交，即关闭事物。</p>
<p>也就是说，每条SQL语句执行就会立即提交到数据库，永久生效，无法对其进行操作。</p>
<p>关闭Connection的自动提交，开启事物。Connection的setAutoCommit方法即可：connection.setAutoCommit(false);</p>
<p>通过connection.getAutoCommit()来获取事物的模式。</p>
<p>当我们开启事物后，在当前Connection中完成的数据库操作，都不会立即提交到数据库，需要调用Connection的commit方法才行。</p>
<p>如果有语句执行失败，可以调用rollback来回滚。</p>
<p>注意：如果Connection遇到未处理的SQLException异常时，系统将非正常退出，系统会自动回滚该事务。</p>
<p>如果程序捕捉了该异常，则需要在异常处理中显示回滚事务。</p>
<p>Connection提供了设置事务中间保存点的方法：setSavepoint，有2个方法可以设置中间点：</p>
<p>Savepoint setSavepoint()：在当前事务中创建一个未命名的中间点，并返回该中间点的Savepoint对象。</p>
<p>Savepoint setSavepoint(String name)：当前事务中创建一个具有指定名称的中间点，并返回该中间点的Savepoint对象</p>
<p>通常setSavepoint(String name)设置中间点的名称，事务回滚并不是通过中间点的名称进行回滚的，而是根据中间点对象进行回滚的。</p>
<p>设置名称只是更好的区分中间点对象，用Connection的rollback(Savepoint savepoint)方法即可完成回滚到指定中间点。</p>
<ol start="3">
<li>JDBC的批量更新</li>
</ol>
<p>批量更新就是可以同时进行多条SQL语句，将会被作为一批操作被同时执行、同时提交。</p>
<p>批量更新需要得到数据底层的支持，可以通过调研DataBaseMetaData的supportsBatchUpdates方法来查看底层数据库是否支持批量更新。</p>
<p>批量更新也需要创建一个Statement对象，然后通过该对象的addBatch方法将多条SQL语句同时收集在一起，</p>
<p>然后通过Statement对象的executeBatch同时执行这些SQL语句，如下代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Statement sm = conn.createStatement();</span><br><span class="line">sm.addBatch(sql);</span><br><span class="line">sm.addBatch(sql2);</span><br><span class="line">sm.addBatch(sql3);</span><br><span class="line">…</span><br><span class="line"><span class="comment">//同时执行多条SQL语句</span></span><br><span class="line">sm.executeBatch();</span><br></pre></td></tr></table></figure>
<p>执行executeBatch将返回一个int[]的数组，因为使用Statement执行DDL、DML都将返回一个int的值，而执行多条DDL、DML也将返回一个int数组。批量更新中不允许出现select查询语句，一旦出现程序将出现异常。</p>
<p>如果要批量更新正确、批量完成，需要用单个事务，如果批量更新过程中有失败，则需要用事务回滚到原始状态。</p>
<p>如果要达到这样的效果，需要关闭事务的自动提交，当批量更新完成再提交事务，如果出现异常将回滚事务。</p>
<p>然后将连接恢复成自动提交模式。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] executeBatch(String[] sql) <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">int</span>[] result = <span class="keyword">null</span>;</span><br><span class="line">        conn = DBHelper.getConnection();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//获得当前Connection的提交模式</span></span><br><span class="line">        <span class="keyword">boolean</span> autoCommit = conn.getAutoCommit();</span><br><span class="line">        <span class="comment">//关闭自动提交模式</span></span><br><span class="line">        conn.setAutoCommit(<span class="keyword">false</span>);</span><br><span class="line">        sm = conn.createStatement();</span><br><span class="line">        <span class="keyword">for</span> (String s : sql) &#123;</span><br><span class="line">                        sm.addBatch(s);</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="comment">//执行批量更新</span></span><br><span class="line">        result = sm.executeBatch();</span><br><span class="line">        <span class="comment">//提交事务</span></span><br><span class="line">        conn.commit();</span><br><span class="line">        <span class="comment">//还原提交模式</span></span><br><span class="line">        conn.setAutoCommit(autoCommit);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">                conn.rollback();</span><br><span class="line">                &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (sm != <span class="keyword">null</span>) &#123;</span><br><span class="line">                sm.close();</span><br><span class="line">                &#125;</span><br><span class="line">                DBHelper.close();</span><br><span class="line">                &#125;</span><br><span class="line">                 <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="六、分析数据库数据"><a href="#六、分析数据库数据" class="headerlink" title="六、分析数据库数据"></a>六、分析数据库数据</h2><ol>
<li>使用DatabaseMetaData分析数据库数据</li>
</ol>
<p>JDBC提供了DatabaseMetaData来封装数据库连接对应的数据库信息，通过Connection的getMetaData方法来获取该对象。</p>
<p>DatabaseMetaData接口通常数据库驱动提供商完成实现，其作用是让用户了解数据库的底层信息。</p>
<p>使用该接口可以了解数据库底层的实现，便于完成多个数据库的相互切换。</p>
<p>如：可以利用supportsCorrelatedSubquenes方法来查看数据库底层是否可以利用关联子查询，或是调用supportsBatchUpdates方法查看是否支持批量更新。</p>
<p>大部分的DatabaseMetaData都是以ResultSet对象返回的，可以通过ResultSet对象的getString、getInt来获取相关信息。<br>DatabaseMetaData方法都需要传递一个xxxPattern的模式字符串，这个字符串是过滤条件，一般传递是SQL中的%、_等内容。<br>如果传递一个null表示不作任何过滤。</p>
</section>
    <!-- Tags START -->
    
      <div class="tags">
        <span>Tags:</span>
        
  <a href="/tags#Java" >
    <span class="tag-code">Java</span>
  </a>

      </div>
    
    <!-- Tags END -->
    <!-- NAV START -->
    
  <div class="nav-container">
    <!-- reverse left and right to put prev and next in a more logic postition -->
    
      <a class="nav-left" href="/blog/59531.html">
        <span class="nav-arrow">← </span>
        
          Java成神之路-Java异常、集合、IO流、多线程和反射（六）
        
      </a>
    
    
      <a class="nav-right" href="/blog/56228.html">
        
          Java成神之路-Tomcat、Jsp/servlet、Ajax（八）
        
        <span class="nav-arrow"> →</span>
      </a>
    
  </div>

    <!-- NAV END -->
    <!-- 打赏 START -->
    
      <div class="money-like">
        <div class="reward-btn">
          赏
          <span class="money-code">
            <span class="alipay-code">
              <div class="code-image"></div>
              <b>使用支付宝打赏</b>
            </span>
            <span class="wechat-code">
              <div class="code-image"></div>
              <b>使用微信打赏</b>
            </span>
          </span>
        </div>
        <p class="notice">若你觉得我的文章对你有帮助，欢迎点击上方按钮对我打赏</p>
      </div>
    
    <!-- 打赏 END -->
    <!-- 二维码 START -->
    
      <div class="qrcode">
        <canvas id="share-qrcode"></canvas>
        <p class="notice">扫描二维码，分享此文章</p>
      </div>
    
    <!-- 二维码 END -->
    
      <!-- Gitment START -->
      <div id="comments"></div>
      <!-- Gitment END -->
    
  </article>
  <!-- Article END -->
  <!-- Catalog START -->
  
    <aside class="catalog-container">
  <div class="toc-main">
    <strong class="toc-title">Catalog</strong>
    
      <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#Mysql数据库"><span class="toc-nav-text">Mysql数据库</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#常用命令"><span class="toc-nav-text">常用命令</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#修改密码"><span class="toc-nav-text">修改密码</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#授权"><span class="toc-nav-text">授权</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#备份"><span class="toc-nav-text">备份</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#基础"><span class="toc-nav-text">基础</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#提升"><span class="toc-nav-text">提升</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#技巧"><span class="toc-nav-text">技巧</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#数据开发"><span class="toc-nav-text">数据开发</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#PowerDesigner设计建造MySQL数据库"><span class="toc-nav-text">PowerDesigner设计建造MySQL数据库</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#制作建库脚本"><span class="toc-nav-text">制作建库脚本</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#执行sql脚本"><span class="toc-nav-text">执行sql脚本</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#第一种方法"><span class="toc-nav-text">第一种方法:</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#第二种方法"><span class="toc-nav-text">第二种方法:</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#JDBC"><span class="toc-nav-text">JDBC</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#JDBC概念"><span class="toc-nav-text">JDBC概念</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#一、JDBC常用接口、类介绍"><span class="toc-nav-text">一、JDBC常用接口、类介绍</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#DriverManager"><span class="toc-nav-text">DriverManager</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#Connection常用数据库操作方法："><span class="toc-nav-text">Connection常用数据库操作方法：</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#Connection控制事务"><span class="toc-nav-text">Connection控制事务</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#Statement"><span class="toc-nav-text">Statement</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#PreparedStatement"><span class="toc-nav-text">PreparedStatement</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#ResultSet"><span class="toc-nav-text">ResultSet</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#二、JDBC编程步骤"><span class="toc-nav-text">二、JDBC编程步骤</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#三、JDBC执行SQL语句"><span class="toc-nav-text">三、JDBC执行SQL语句</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#四、操作结果集-ResultSet"><span class="toc-nav-text">四、操作结果集(ResultSet)</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#resultSetType：控制ResultSet的类型，该参数有以下三个值："><span class="toc-nav-text">resultSetType：控制ResultSet的类型，该参数有以下三个值：</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#resultSetConcurrency：控制ResultSet的并发类型，该参数可以接收如下两个值："><span class="toc-nav-text">resultSetConcurrency：控制ResultSet的并发类型，该参数可以接收如下两个值：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#五、JDBC事务"><span class="toc-nav-text">五、JDBC事务</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#六、分析数据库数据"><span class="toc-nav-text">六、分析数据库数据</span></a></li></ol></li></ol>
    
  </div>
</aside>
  
  <!-- Catalog END -->
</main>

<script>
  (function () {
    var url = 'http://m.iskei.cn/blog/786.html';
    var banner = ''
    if (banner !== '' && banner !== 'undefined' && banner !== 'null') {
      $('#article-banner').css({
        'background-image': 'url(' + banner + ')'
      })
    } else {
      $('#article-banner').geopattern(url)
    }
    $('.header').removeClass('fixed-header')

     // error image
    $(".markdown-content img").on('error', function() {
      $(this).attr('src', 'http://file.muyutech.com/error-img.png')
      $(this).css({
        'cursor': 'default'
      })
    })

    // zoom image
    $(".markdown-content img").on('click', function() {
      var src = $(this).attr('src')
      if (src !== 'http://file.muyutech.com/error-img.png') {
        var imageW = $(this).width()
        var imageH = $(this).height()
        
        var zoom = ($(window).width() * 0.95 / imageW).toFixed(2)
        zoom = zoom < 1 ? 1 : zoom
        zoom = zoom > 2 ? 2 : zoom
        var transY = (($(window).height() - imageH) / 2).toFixed(2)

        $('body').append('<div class="image-view-wrap"><div class="image-view-inner"><img src="'+ src +'" /></div></div>')
        $('.image-view-wrap').addClass('wrap-active')
        $('.image-view-wrap img').css({
          'width': `${imageW}`,
          'transform': `translate3d(0, ${transY}px, 0) scale3d(${zoom}, ${zoom}, 1)`
        })
        $('html').css('overflow', 'hidden')

        $('.image-view-wrap').on('click', function() {
          $(this).remove()
          $('html').attr('style', '')
        })
      }
    })

    // qrcode
    var qr = new QRious({
      element: document.getElementById('share-qrcode'),
      value: document.location.href
    });

    // gitment
    var gitmentConfig = "imcco";
    if (gitmentConfig !== 'undefined') {
      var gitment = new Gitment({
        id: "Java成神之路-数据库、PowerDesigner、JDBC（七）",
        owner: "imcco",
        repo: "m.github.io",
        oauth: {
          client_id: "ee7ec372a862879e3f2c",
          client_secret: "00a58ccb1a0555f87a87dc3a1b779ee8d12ded80"
        },
        theme: {
          render(state, instance) {
            const container = document.createElement('div')
            container.lang = "en-US"
            container.className = 'gitment-container gitment-root-container'
            container.appendChild(instance.renderHeader(state, instance))
            container.appendChild(instance.renderEditor(state, instance))
            container.appendChild(instance.renderComments(state, instance))
            container.appendChild(instance.renderFooter(state, instance))
            return container;
          }
        }
      })
      gitment.render(document.getElementById('comments'))
    }
  })();
</script>

    <div class="scroll-top">
  <span class="arrow-icon"></span>
</div>
    <footer class="app-footer">
  <p class="copyright">
    &copy; 2018 | Proudly powered by <a href="https://vuejs.io" target="_blank">vueJs</a>
    <br>
    Theme by <a href="https://github.com/imcco">Imcco</a>
  </p>
</footer>

<script>
  function async(u, c) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }
</script>
<script>
  async("//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
    FastClick.attach(document.body);
  })
</script>

<script>
  var hasLine = 'true';
  async("//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js", function(){
    $('figure pre').each(function(i, block) {
      var figure = $(this).parents('figure');
      if (hasLine === 'false') {
        figure.find('.gutter').hide();
      }
      var lang = figure.attr('class').split(' ')[1] || 'code';
      var codeHtml = $(this).html();
      var codeTag = document.createElement('code');
      codeTag.className = lang;
      codeTag.innerHTML = codeHtml;
      $(this).attr('class', '').empty().html(codeTag);
      figure.attr('data-lang', lang.toUpperCase());
      hljs.highlightBlock(block);
    });
  })
</script>
<!-- Baidu Tongji -->

<script src="/js/script.js"></script>

  </body>
</html>